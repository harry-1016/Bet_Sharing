<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Admin panel for betting tracker">
    <meta name="theme-color" content="#0a0e1a">
    <link rel="manifest" href="./manifest-admin.json">
    <title>Betting Tracker - Admin</title>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-messaging-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0e1a;
            color: white;
            min-height: 100vh;
            padding: 1rem;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: linear-gradient(135deg, rgba(147, 51, 234, 0.2) 0%, rgba(239, 68, 68, 0.2) 100%);
            border: 1px solid rgba(147, 51, 234, 0.3);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .title {
            font-size: 2rem;
            font-weight: 800;
            background: linear-gradient(135deg, #9333ea 0%, #ef4444 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }
        
        .subtitle {
            color: #8b92b0;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 16px;
            margin-bottom: 1.5rem;
        }
        
        .input, .select, .textarea {
            width: 100%;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 1rem;
            margin-bottom: 1rem;
            font-family: inherit;
        }
        
        .textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .input:focus, .select:focus, .textarea:focus {
            outline: none;
            border-color: #9333ea;
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #9333ea 0%, #ef4444 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
        }
        
        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-notification {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
        }
        
        .btn-success {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }
        
        .btn-danger {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .btn-gray {
            background: rgba(255, 255, 255, 0.05);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .bet-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .bet-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .bet-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .detail-label {
            color: #8b92b0;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .detail-value {
            font-size: 1.125rem;
            font-weight: 700;
            margin-top: 0.25rem;
        }
        
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            margin-right: 0.5rem;
        }
        
        .badge-cricket {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }
        
        .badge-tennis {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }
        
        .badge-pending {
            background: rgba(250, 204, 21, 0.2);
            color: #facc15;
        }
        
        .badge-won {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }
        
        .badge-lost {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .badge-void {
            background: rgba(156, 163, 175, 0.2);
            color: #9ca3af;
        }
        
        .login-container {
            max-width: 400px;
            margin: 5rem auto;
            text-align: center;
        }
        
        .login-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 2rem;
            border-radius: 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: rgba(147, 51, 234, 0.1);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
        }
        
        .stat-label {
            color: #8b92b0;
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-top: 0.5rem;
        }
        
        .action-buttons {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        
        .error-message {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .success-message {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }
        
        .loading {
            text-align: center;
            padding: 3rem;
            color: #8b92b0;
        }
        
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }
        
        .tab {
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.03);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .tab.active {
            background: linear-gradient(135deg, #9333ea 0%, #ef4444 100%);
            border-color: transparent;
        }
        
        .notification-history {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .notification-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.75rem;
        }
        
        .notification-item-title {
            font-weight: 700;
            margin-bottom: 0.25rem;
        }
        
        .notification-item-message {
            color: #8b92b0;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }
        
        .notification-item-time {
            color: #6b7280;
            font-size: 0.75rem;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCkmo-yTbEd8LE6XtAPsJkmstLos7wlUew",
            authDomain: "bet-sharing.firebaseapp.com",
            projectId: "bet-sharing",
            storageBucket: "bet-sharing.firebasestorage.app",
            messagingSenderId: "21069245479",
            appId: "1:21069245479:web:a851ffb095ddb1b93a7202"
        };

        // Admin password
        const ADMIN_PASSWORD = 'Hari@1016';

        // Initialize Firebase
        let db = null;
        let auth = null;
        let messaging = null;
        let firebaseInitialized = false;

        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            auth = firebase.auth();
            
            if (firebase.messaging.isSupported()) {
                messaging = firebase.messaging();
            }
            
            firebaseInitialized = true;
            console.log('‚úÖ Firebase initialized');
        } catch (error) {
            console.error('‚ùå Firebase initialization failed:', error);
        }

        // State
        let bets = [];
        let sentNotifications = [];
        let isAuthenticated = false;
        let currentUser = null;
        let syncStatus = 'synced';
        let showAddForm = false;
        let showNotificationForm = false;
        let isLoggingIn = false;
        let loginError = null;
        let notificationSuccess = null;
        let activeTab = 'bets'; // 'bets' or 'notifications'

        // Check for stored auth state
        const storedAuth = localStorage.getItem('adminAuth');
        if (storedAuth === 'true') {
            isAuthenticated = true;
        }

        // Authentication
        function checkPassword() {
            const passwordInput = document.getElementById('password');
            const password = passwordInput.value;
            
            if (isLoggingIn) return;
            
            if (!password) {
                loginError = 'Please enter a password';
                render();
                return;
            }
            
            if (password === ADMIN_PASSWORD) {
                isLoggingIn = true;
                loginError = null;
                isAuthenticated = true;
                localStorage.setItem('adminAuth', 'true');
                render();
                signInAdmin();
            } else {
                loginError = 'Incorrect password!';
                passwordInput.value = '';
                render();
            }
        }

        async function signInAdmin() {
            if (!firebaseInitialized) {
                isLoggingIn = false;
                return;
            }
            
            try {
                await auth.signInAnonymously();
                console.log('‚úÖ Signed in to Firebase');
            } catch (error) {
                console.error('Sign-in error:', error);
                loginError = 'Connection error. Please try again.';
                isAuthenticated = false;
                isLoggingIn = false;
                localStorage.removeItem('adminAuth');
                render();
            }
        }

        function logout() {
            isAuthenticated = false;
            localStorage.removeItem('adminAuth');
            if (auth) {
                auth.signOut();
            }
            currentUser = null;
            bets = [];
            sentNotifications = [];
            showAddForm = false;
            showNotificationForm = false;
            render();
        }

        // Listen to auth state
        if (firebaseInitialized) {
            auth.onAuthStateChanged((user) => {
                currentUser = user;
                isLoggingIn = false;
                if (user && isAuthenticated) {
                    loadBets();
                    loadNotifications();
                } else if (!user && isAuthenticated) {
                    signInAdmin();
                }
                render();
            });
        }

        // Load bets
        function loadBets() {
            if (!firebaseInitialized || !db) return;

            db.collection('bets')
                .orderBy('timestamp', 'desc')
                .onSnapshot((snapshot) => {
                    bets = [];
                    snapshot.forEach((doc) => {
                        const data = doc.data();
                        bets.push({
                            id: doc.id,
                            sport: data.sport,
                            match: data.match,
                            bet: data.bet,
                            stake: parseFloat(data.stake),
                            odds: parseFloat(data.odds),
                            potentialReturn: parseFloat(data.potentialReturn),
                            outcome: data.outcome || 'pending',
                            profit: parseFloat(data.profit || 0),
                            timestamp: data.timestamp?.toDate() || new Date()
                        });
                    });
                    
                    syncStatus = 'synced';
                    render();
                }, (error) => {
                    console.error('Error loading bets:', error);
                    syncStatus = 'error';
                    render();
                });
        }

        // Load sent notifications
        function loadNotifications() {
            if (!firebaseInitialized || !db) return;

            db.collection('notifications')
                .orderBy('timestamp', 'desc')
                .limit(20)
                .onSnapshot((snapshot) => {
                    sentNotifications = [];
                    
                    snapshot.forEach((doc) => {
                        const data = doc.data();
                        sentNotifications.push({
                            id: doc.id,
                            title: data.title,
                            message: data.message,
                            type: data.type || 'info',
                            timestamp: data.timestamp?.toDate() || new Date()
                        });
                    });
                    
                    render();
                }, (error) => {
                    console.error('Error loading notifications:', error);
                });
        }

        // Send notification
        async function sendNotification(event) {
            event.preventDefault();
            if (!firebaseInitialized || !db || !currentUser) {
                alert('Not connected to database');
                return;
            }

            const formData = new FormData(event.target);
            const title = formData.get('title');
            const message = formData.get('message');
            const type = formData.get('type');

            try {
                // Save notification to Firestore
                await db.collection('notifications').add({
                    title: title,
                    message: message,
                    type: type,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    sentBy: currentUser.uid
                });

                notificationSuccess = 'Notification sent successfully!';
                showNotificationForm = false;
                event.target.reset();
                
                // Auto-clear success message
                setTimeout(() => {
                    notificationSuccess = null;
                    render();
                }, 3000);
                
                render();
            } catch (error) {
                console.error('Error sending notification:', error);
                alert('Failed to send notification: ' + error.message);
            }
        }

        // Add bet
        async function addBet(event) {
            event.preventDefault();
            if (!firebaseInitialized || !db || !currentUser) {
                alert('Not connected to database');
                return;
            }

            const formData = new FormData(event.target);
            const stake = parseFloat(formData.get('stake'));
            const odds = parseFloat(formData.get('odds'));

            try {
                await db.collection('bets').add({
                    sport: formData.get('sport'),
                    match: formData.get('match'),
                    bet: formData.get('bet'),
                    stake: stake,
                    odds: odds,
                    potentialReturn: stake * odds,
                    outcome: 'pending',
                    profit: 0,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    userId: currentUser.uid
                });

                showAddForm = false;
                event.target.reset();
                render();
            } catch (error) {
                console.error('Error adding bet:', error);
                alert('Failed to add bet: ' + error.message);
            }
        }

        // Update outcome
        async function updateOutcome(betId, outcome) {
            if (!firebaseInitialized || !db) return;

            const bet = bets.find(b => b.id === betId);
            if (!bet) return;

            let profit = 0;
            if (outcome === 'won') {
                profit = bet.potentialReturn - bet.stake;
            } else if (outcome === 'lost') {
                profit = -bet.stake;
            } else if (outcome === 'void') {
                profit = 0; // Stake returned, no profit or loss
            }

            try {
                await db.collection('bets').doc(betId).update({
                    outcome: outcome,
                    profit: profit
                });
            } catch (error) {
                console.error('Error updating bet:', error);
                alert('Failed to update bet: ' + error.message);
            }
        }

        // Delete bet
        async function deleteBet(betId) {
            if (!firebaseInitialized || !db) return;
            if (!confirm('Are you sure you want to delete this bet?')) return;

            try {
                await db.collection('bets').doc(betId).delete();
            } catch (error) {
                console.error('Error deleting bet:', error);
                alert('Failed to delete bet: ' + error.message);
            }
        }

        // Delete notification
        async function deleteNotification(notifId) {
            if (!firebaseInitialized || !db) return;
            if (!confirm('Are you sure you want to delete this notification?')) return;

            try {
                await db.collection('notifications').doc(notifId).delete();
            } catch (error) {
                console.error('Error deleting notification:', error);
                alert('Failed to delete notification: ' + error.message);
            }
        }

        // Calculate statistics
        function calculateStats() {
            const totalBets = bets.length;
            const wonBets = bets.filter(b => b.outcome === 'won').length;
            const lostBets = bets.filter(b => b.outcome === 'lost').length;
            const pendingBets = bets.filter(b => b.outcome === 'pending').length;
            const totalStake = bets.reduce((sum, b) => sum + b.stake, 0);
            const totalProfit = bets.reduce((sum, b) => sum + b.profit, 0);
            const winRate = totalBets > 0 ? ((wonBets / (wonBets + lostBets)) * 100 || 0) : 0;
            
            return {
                totalBets,
                wonBets,
                lostBets,
                pendingBets,
                totalStake: totalStake.toFixed(2),
                totalProfit: totalProfit.toFixed(2),
                winRate: winRate.toFixed(1)
            };
        }

        // Format time ago
        function timeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            
            if (seconds < 60) return 'Just now';
            if (seconds < 3600) return Math.floor(seconds / 60) + 'm ago';
            if (seconds < 86400) return Math.floor(seconds / 3600) + 'h ago';
            return Math.floor(seconds / 86400) + 'd ago';
        }

        // Render
        function render() {
            const root = document.getElementById('root');

            if (!isAuthenticated) {
                root.innerHTML = `
                    <div class="login-container">
                        <div class="login-card">
                            <div style="font-size: 4rem; margin-bottom: 1rem;">üîê</div>
                            <h1 class="title">Admin Login</h1>
                            <p class="subtitle" style="margin-bottom: 2rem;">Enter password to continue</p>
                            
                            ${loginError ? `<div class="error-message">${loginError}</div>` : ''}
                            
                            <input 
                                type="password" 
                                id="password" 
                                class="input" 
                                placeholder="Password" 
                                onkeypress="if(event.key==='Enter') checkPassword()"
                                ${isLoggingIn ? 'disabled' : ''}
                            >
                            <button 
                                class="btn btn-primary" 
                                onclick="checkPassword()" 
                                style="width: 100%;"
                                ${isLoggingIn ? 'disabled' : ''}
                            >
                                ${isLoggingIn ? 'Logging in...' : 'Login'}
                            </button>
                        </div>
                    </div>
                `;
                
                setTimeout(() => {
                    const input = document.getElementById('password');
                    if (input) input.focus();
                }, 100);
                
                return;
            }

            if (isLoggingIn || !currentUser) {
                root.innerHTML = `
                    <div class="loading">
                        <div style="font-size: 4rem; margin-bottom: 1rem;">‚è≥</div>
                        <h2>Connecting to database...</h2>
                    </div>
                `;
                return;
            }

            const stats = calculateStats();

            let content = `
                <div class="container">
                    <div class="header">
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                            <div>
                                <h1 class="title">üéØ Admin Panel</h1>
                                <p class="subtitle">Manage bets & notifications</p>
                            </div>
                            <button class="btn btn-gray" onclick="logout()">Logout</button>
                        </div>
                    </div>

                    ${notificationSuccess ? `<div class="success-message">${notificationSuccess}</div>` : ''}

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">Total Bets</div>
                            <div class="stat-value">${stats.totalBets}</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Won</div>
                            <div class="stat-value" style="color: #22c55e">${stats.wonBets}</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Lost</div>
                            <div class="stat-value" style="color: #ef4444">${stats.lostBets}</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Win Rate</div>
                            <div class="stat-value">${stats.winRate}%</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Total Profit/Loss</div>
                            <div class="stat-value" style="color: ${parseFloat(stats.totalProfit) >= 0 ? '#22c55e' : '#ef4444'}">
                                ${parseFloat(stats.totalProfit) >= 0 ? '+' : ''}‚Çπ${parseFloat(stats.totalProfit).toLocaleString()}
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Notifications Sent</div>
                            <div class="stat-value">${sentNotifications.length}</div>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab ${activeTab === 'bets' ? 'active' : ''}" onclick="activeTab = 'bets'; render();">
                            üé≤ Bets
                        </div>
                        <div class="tab ${activeTab === 'notifications' ? 'active' : ''}" onclick="activeTab = 'notifications'; render();">
                            üì¢ Notifications
                        </div>
                    </div>
            `;

            if (activeTab === 'bets') {
                content += `
                    <button class="btn btn-primary" onclick="showAddForm = !showAddForm; render();" style="margin-bottom: 1.5rem;">
                        ${showAddForm ? '‚úñ Cancel' : '+ Add New Bet'}
                    </button>
                `;

                if (showAddForm) {
                    content += `
                        <div class="card">
                            <h2 style="margin-bottom: 1rem;">Add New Bet</h2>
                            <form onsubmit="addBet(event)">
                                <select name="sport" class="select" required>
                                    <option value="">Select Sport</option>
                                    <option value="Cricket">Cricket</option>
                                    <option value="Tennis">Tennis</option>
                                </select>
                                
                                <input type="text" name="match" class="input" placeholder="Match (e.g., India vs Australia)" required>
                                
                                <input type="text" name="bet" class="input" placeholder="Bet Description" required>
                                
                                <input type="number" name="stake" class="input" placeholder="Stake Amount" step="0.01" required>
                                
                                <input type="number" name="odds" class="input" placeholder="Odds (e.g., 1.85)" step="0.01" required>
                                
                                <button type="submit" class="btn btn-primary" style="width: 100%;">Add Bet</button>
                            </form>
                        </div>
                    `;
                }

                if (bets.length === 0) {
                    content += `
                        <div class="card" style="text-align: center; padding: 3rem;">
                            <div style="font-size: 4rem;">üì≠</div>
                            <h2 style="margin-top: 1rem;">No bets yet</h2>
                            <p style="margin-top: 0.5rem; color: #8b92b0;">Add your first bet to get started</p>
                        </div>
                    `;
                } else {
                    bets.forEach(bet => {
                        const sportBadge = bet.sport === 'Cricket' ? 'badge-cricket' : 'badge-tennis';
                        const outcomeBadge = `badge-${bet.outcome}`;
                        
                        content += `
                            <div class="bet-card">
                                <div>
                                    <span class="badge ${sportBadge}">${bet.sport}</span>
                                    <span class="badge ${outcomeBadge}">${bet.outcome}</span>
                                </div>
                                <div class="bet-title">${bet.match}</div>
                                <div style="color: #8b92b0; margin-bottom: 1rem;">${bet.bet}</div>
                                
                                <div class="bet-details">
                                    <div>
                                        <div class="detail-label">Stake</div>
                                        <div class="detail-value">‚Çπ${bet.stake.toLocaleString()}</div>
                                    </div>
                                    <div>
                                        <div class="detail-label">Odds</div>
                                        <div class="detail-value">${bet.odds}</div>
                                    </div>
                                    <div>
                                        <div class="detail-label">Potential Return</div>
                                        <div class="detail-value">‚Çπ${bet.potentialReturn.toLocaleString()}</div>
                                    </div>
                                    <div>
                                        <div class="detail-label">Date</div>
                                        <div class="detail-value">${bet.timestamp.toLocaleDateString()}</div>
                                    </div>
                                </div>
                                
                                <div class="action-buttons">
                                    <button class="btn btn-success" onclick="updateOutcome('${bet.id}', 'won')">Won</button>
                                    <button class="btn btn-danger" onclick="updateOutcome('${bet.id}', 'lost')">Lost</button>
                                    <button class="btn btn-gray" onclick="updateOutcome('${bet.id}', 'void')">Void</button>
                                    <button class="btn btn-gray" onclick="updateOutcome('${bet.id}', 'pending')">Pending</button>
                                    <button class="btn btn-danger" onclick="deleteBet('${bet.id}')">Delete</button>
                                </div>
                            </div>
                        `;
                    });
                }
            } else {
                // Notifications tab
                content += `
                    <button class="btn btn-notification" onclick="showNotificationForm = !showNotificationForm; render();" style="margin-bottom: 1.5rem;">
                        ${showNotificationForm ? '‚úñ Cancel' : 'üì¢ Send Notification'}
                    </button>
                `;

                if (showNotificationForm) {
                    content += `
                        <div class="card">
                            <h2 style="margin-bottom: 1rem;">Send Notification</h2>
                            <form onsubmit="sendNotification(event)">
                                <input type="text" name="title" class="input" placeholder="Notification Title" required maxlength="100">
                                
                                <textarea name="message" class="textarea" placeholder="Notification Message" required maxlength="500"></textarea>
                                
                                <select name="type" class="select" required>
                                    <option value="">Select Type</option>
                                    <option value="info">üì¢ Info</option>
                                    <option value="bet">üéØ Bet Update</option>
                                    <option value="win">üéâ Win</option>
                                    <option value="loss">üò¢ Loss</option>
                                    <option value="update">üîÑ General Update</option>
                                    <option value="warning">‚ö†Ô∏è Warning</option>
                                </select>
                                
                                <button type="submit" class="btn btn-notification" style="width: 100%;">Send to All Users</button>
                            </form>
                        </div>
                    `;
                }

                if (sentNotifications.length === 0) {
                    content += `
                        <div class="card" style="text-align: center; padding: 3rem;">
                            <div style="font-size: 4rem;">üì≠</div>
                            <h2 style="margin-top: 1rem;">No notifications sent</h2>
                            <p style="margin-top: 0.5rem; color: #8b92b0;">Send your first notification to users</p>
                        </div>
                    `;
                } else {
                    content += `
                        <div class="card">
                            <h2 style="margin-bottom: 1rem;">Notification History</h2>
                            <div class="notification-history">
                    `;
                    
                    sentNotifications.forEach(notif => {
                        content += `
                            <div class="notification-item">
                                <div class="notification-item-title">${notif.title}</div>
                                <div class="notification-item-message">${notif.message}</div>
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span class="notification-item-time">${timeAgo(notif.timestamp)} ‚Ä¢ ${notif.type}</span>
                                    <button class="btn btn-danger" style="padding: 0.25rem 0.75rem; font-size: 0.75rem;" onclick="deleteNotification('${notif.id}')">Delete</button>
                                </div>
                            </div>
                        `;
                    });
                    
                    content += `
                            </div>
                        </div>
                    `;
                }
            }

            content += '</div>';
            root.innerHTML = content;
        }

        // Initialize
        render();
        
        if (isAuthenticated && firebaseInitialized) {
            signInAdmin();
        }
    </script>
</body>
</html>
